import{d as ze,af as Fe,f as U,J as D,u as W,g as me,M as $,B as be,O as Ee,F as _,o as K,w as G,r as pe,n as Ke,p as x,m as I,H as De,aG as Re,x as we,aH as re,E as je,ao as te,ar as ie,Z as qe,a7 as se,S as xe,aI as He,ap as Ue,at as Ne,N as Z,I as H,z as ke,W as X,ae as M,k as le,v as ce,h as z,l as he,j as P,G as Y,a4 as O,a3 as Se,aw as Te,aJ as We,K as S,aK as Je,V as Ie,s as Ye,e as ne,ag as Qe,aF as Ge,aE as Ze,aL as Xe}from"./index-DjE6wi1C.js";import{b as Ve}from"./el-checkbox-DZW_ZEyL.js";import{u as et,a as tt,P as nt,b as ot}from"./usePageModal-x_rmGjWf.js";import{P as st}from"./page-content-DotdcTwY.js";import{s as at}from"./format-B4vquexf.js";import{E as dt}from"./index-CDiTnLy9.js";import{_ as ae,r as de,h as rt,E as it,e as lt,d as B,j as ct}from"./aria-CW2vG8jH.js";import{b as ht,i as ut}from"./el-button-uHYO9Pi-.js";import"./el-form-item-CqIBjJyG.js";import"./el-col-DP6Bp5ur.js";import"./el-scrollbar-CyxxYyB_.js";import"./el-popper-DDphpXHv.js";import"./el-overlay-BlC4Qfdl.js";import"./refs-_qraV61z.js";const ft=ze({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Fe,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),pt=U({name:"ElText"}),gt=U({...pt,props:ft,setup(t){const e=t,n=D(),a=ht(),o=W("text"),s=me(()=>[o.b(),o.m(e.type),o.m(a.value),o.is("truncated",e.truncated),o.is("line-clamp",!$(e.lineClamp))]),d=()=>{var l,c,g,r,y,u,N;if(Re().title)return;let p=!1;const k=((l=n.value)==null?void 0:l.textContent)||"";if(e.truncated){const m=(c=n.value)==null?void 0:c.offsetWidth,b=(g=n.value)==null?void 0:g.scrollWidth;m&&b&&b>m&&(p=!0)}else if(!$(e.lineClamp)){const m=(r=n.value)==null?void 0:r.offsetHeight,b=(y=n.value)==null?void 0:y.scrollHeight;m&&b&&b>m&&(p=!0)}p?(u=n.value)==null||u.setAttribute("title",k):(N=n.value)==null||N.removeAttribute("title")};return be(d),Ee(d),(l,c)=>(K(),_(De(l.tag),{ref_key:"textRef",ref:n,class:x(I(s)),style:Ke({"-webkit-line-clamp":l.lineClamp})},{default:G(()=>[pe(l.$slots,"default")]),_:3},8,["class","style"]))}});var yt=ae(gt,[["__file","text.vue"]]);const Nt=we(yt),q="$treeNodeId",Ce=function(t,e){!e||e[q]||Object.defineProperty(e,q,{value:t.id,enumerable:!1,configurable:!1,writable:!1})},ge=(t,e)=>e==null?void 0:e[t||q],ue=(t,e,n)=>{const a=t.value.currentNode;n();const o=t.value.currentNode;a!==o&&e("current-change",o?o.data:null,o)},fe=t=>{let e=!0,n=!0,a=!0;for(let o=0,s=t.length;o<s;o++){const d=t[o];(d.checked!==!0||d.indeterminate)&&(e=!1,d.disabled||(a=!1)),(d.checked!==!1||d.indeterminate)&&(n=!1)}return{all:e,none:n,allWithoutDisable:a,half:!e&&!n}},Q=function(t){if(t.childNodes.length===0||t.loading)return;const{all:e,none:n,half:a}=fe(t.childNodes);e?(t.checked=!0,t.indeterminate=!1):a?(t.checked=!1,t.indeterminate=!0):n&&(t.checked=!1,t.indeterminate=!1);const o=t.parent;!o||o.level===0||t.store.checkStrictly||Q(o)},oe=function(t,e){const n=t.store.props,a=t.data||{},o=n[e];if(se(o))return o(a,t);if(xe(o))return a[o];if($(o)){const s=a[e];return $(s)?"":s}};let kt=0;class F{constructor(e){this.isLeafByUser=void 0,this.isLeaf=void 0,this.id=kt++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const n in e)re(e,n)&&(this[n]=e[n]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){var e;const n=this.store;if(!n)throw new Error("[Node]store is required!");n.registerNode(this);const a=n.props;if(a&&typeof a.isLeaf<"u"){const d=oe(this,"isLeaf");je(d)&&(this.isLeafByUser=d)}if(n.lazy!==!0&&this.data?(this.setData(this.data),n.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&n.lazy&&n.defaultExpandAll&&!this.isLeafByUser&&this.expand(),te(this.data)||Ce(this,this.data),!this.data)return;const o=n.defaultExpandedKeys,s=n.key;s&&!ie(this.key)&&o&&o.includes(this.key)&&this.expand(null,n.autoExpandParent),s&&n.currentNodeKey!==void 0&&this.key===n.currentNodeKey&&(n.currentNode=this,n.currentNode.isCurrent=!0),n.lazy&&n._initDefaultCheckedNode(this),this.updateLeafState(),(this.level===1||((e=this.parent)==null?void 0:e.expanded)===!0)&&(this.canFocus=!0)}setData(e){te(e)||Ce(this,e),this.data=e,this.childNodes=[];let n;this.level===0&&te(this.data)?n=this.data:n=oe(this,"children")||[];for(let a=0,o=n.length;a<o;a++)this.insertChild({data:n[a]})}get label(){return oe(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return oe(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const n=e.childNodes.indexOf(this);if(n>-1)return e.childNodes[n+1]}return null}get previousSibling(){const e=this.parent;if(e){const n=e.childNodes.indexOf(this);if(n>-1)return n>0?e.childNodes[n-1]:null}return null}contains(e,n=!0){return(this.childNodes||[]).some(a=>a===e||n&&a.contains(e))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,n,a){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof F)){if(!a){const o=this.getChildren(!0);o!=null&&o.includes(e.data)||($(n)||n<0?o==null||o.push(e.data):o==null||o.splice(n,0,e.data))}Object.assign(e,{parent:this,store:this.store}),e=qe(new F(e)),e instanceof F&&e.initialize()}e.level=this.level+1,$(n)||n<0?this.childNodes.push(e):this.childNodes.splice(n,0,e),this.updateLeafState()}insertBefore(e,n){let a;n&&(a=this.childNodes.indexOf(n)),this.insertChild(e,a)}insertAfter(e,n){let a;n&&(a=this.childNodes.indexOf(n),a!==-1&&(a+=1)),this.insertChild(e,a)}removeChild(e){const n=this.getChildren()||[],a=n.indexOf(e.data);a>-1&&n.splice(a,1);const o=this.childNodes.indexOf(e);o>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(o,1)),this.updateLeafState()}removeChildByData(e){let n=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===e){n=this.childNodes[a];break}n&&this.removeChild(n)}expand(e,n){const a=()=>{if(n){let o=this.parent;for(;o&&o.level>0;)o.expanded=!0,o=o.parent}this.expanded=!0,e&&e(),this.childNodes.forEach(o=>{o.canFocus=!0})};this.shouldLoadData()?this.loadData(o=>{te(o)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Q(this),a())}):a()}doCreateChildren(e,n={}){e.forEach(a=>{this.insertChild(Object.assign({data:a},n),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(e=>{e.canFocus=!1})}shouldLoadData(){return!!(this.store.lazy===!0&&this.store.load&&!this.loaded)}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const e=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!e||e.length===0;return}this.isLeaf=!1}setChecked(e,n,a,o){if(this.indeterminate=e==="half",this.checked=e===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:d,allWithoutDisable:l}=fe(this.childNodes);!this.isLeaf&&!d&&l&&(this.checked=!1,e=!1);const c=()=>{if(n){const g=this.childNodes;for(let u=0,N=g.length;u<N;u++){const f=g[u];o=o||e!==!1;const p=f.disabled?f.checked:o;f.setChecked(p,n,!0,o)}const{half:r,all:y}=fe(g);y||(this.checked=y,this.indeterminate=r)}};if(this.shouldLoadData()){this.loadData(()=>{c(),Q(this)},{checked:e!==!1});return}else c()}const s=this.parent;!s||s.level===0||a||Q(s)}getChildren(e=!1){if(this.level===0)return this.data;const n=this.data;if(!n)return null;const a=this.store.props;let o="children";return a&&(o=a.children||"children"),$(n[o])&&(n[o]=null),e&&!n[o]&&(n[o]=[]),n[o]}updateChildren(){const e=this.getChildren()||[],n=this.childNodes.map(s=>s.data),a={},o=[];e.forEach((s,d)=>{const l=s[q];!!l&&n.findIndex(g=>(g==null?void 0:g[q])===l)>=0?a[l]={index:d,data:s}:o.push({index:d,data:s})}),this.store.lazy||n.forEach(s=>{a[s==null?void 0:s[q]]||this.removeChildByData(s)}),o.forEach(({index:s,data:d})=>{this.insertChild({data:d},s)}),this.updateLeafState()}loadData(e,n={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(n).length)){this.loading=!0;const a=s=>{this.childNodes=[],this.doCreateChildren(s,n),this.loaded=!0,this.loading=!1,this.updateLeafState(),e&&e.call(this,s)},o=()=>{this.loading=!1};this.store.load(this,a,o)}else e&&e.call(this)}eachNode(e){const n=[this];for(;n.length;){const a=n.shift();n.unshift(...a.childNodes),e(a)}}reInitChecked(){this.store.checkStrictly||Q(this)}}class Ct{constructor(e){this.lazy=!1,this.checkStrictly=!1,this.autoExpandParent=!1,this.defaultExpandAll=!1,this.checkDescendants=!1,this.currentNode=null,this.currentNodeKey=null;for(const n in e)re(e,n)&&(this[n]=e[n]);this.nodesMap={}}initialize(){if(this.root=new F({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const e=this.load;e(this.root,n=>{this.root.doCreateChildren(n),this._initDefaultCheckedNodes()},He)}else this._initDefaultCheckedNodes()}filter(e){const n=this.filterNodeMethod,a=this.lazy,o=async function(s){const d=s.root?s.root.childNodes:s.childNodes;for(const[l,c]of d.entries())c.visible=!!(n!=null&&n.call(c,e,c.data,c)),l%80===0&&l>0&&await Z(),await o(c);if(!s.visible&&d.length){let l=!0;l=!d.some(c=>c.visible),s.root?s.root.visible=l===!1:s.visible=l===!1}e&&s.visible&&!s.isLeaf&&(!a||s.loaded)&&s.expand()};o(this)}setData(e){e!==this.root.data?(this.nodesMap={},this.root.setData(e),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(e){if(e instanceof F)return e;const n=Ue(e)?ge(this.key,e):e;return this.nodesMap[n]||null}insertBefore(e,n){var a;const o=this.getNode(n);(a=o.parent)==null||a.insertBefore({data:e},o)}insertAfter(e,n){var a;const o=this.getNode(n);(a=o.parent)==null||a.insertAfter({data:e},o)}remove(e){const n=this.getNode(e);n&&n.parent&&(n===this.currentNode&&(this.currentNode=null),n.parent.removeChild(n))}append(e,n){const a=Ne(n)?this.root:this.getNode(n);a&&a.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],n=this.nodesMap;e.forEach(a=>{const o=n[a];o&&o.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(e){const n=this.defaultCheckedKeys||[];!ie(e.key)&&n.includes(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const n=this.key;if(!(!e||!e.data))if(!n)this.nodesMap[e.id]=e;else{const a=e.key;ie(a)||(this.nodesMap[a]=e)}}deregisterNode(e){!this.key||!e||!e.data||(e.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,n=!1){const a=[],o=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(l=>{(l.checked||n&&l.indeterminate)&&(!e||e&&l.isLeaf)&&a.push(l.data),o(l)})};return o(this),a}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map(n=>(n||{})[this.key])}getHalfCheckedNodes(){const e=[],n=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(s=>{s.indeterminate&&e.push(s.data),n(s)})};return n(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(e=>(e||{})[this.key])}_getAllNodes(){const e=[],n=this.nodesMap;for(const a in n)re(n,a)&&e.push(n[a]);return e}updateChildren(e,n){const a=this.nodesMap[e];if(!a)return;const o=a.childNodes;for(let s=o.length-1;s>=0;s--){const d=o[s];this.remove(d.data)}for(let s=0,d=n.length;s<d;s++){const l=n[s];this.append(l,a.data)}}_setCheckedKeys(e,n=!1,a){const o=this._getAllNodes().sort((c,g)=>c.level-g.level),s=Object.create(null),d=Object.keys(a);o.forEach(c=>c.setChecked(!1,!1));const l=c=>{c.childNodes.forEach(g=>{var r;s[g.data[e]]=!0,(r=g.childNodes)!=null&&r.length&&l(g)})};for(let c=0,g=o.length;c<g;c++){const r=o[c],y=r.data[e].toString();if(!d.includes(y)){r.checked&&!s[y]&&r.setChecked(!1,!1);continue}if(r.childNodes.length&&l(r),r.isLeaf||this.checkStrictly){r.setChecked(!0,!1);continue}if(r.setChecked(!0,!0),n){r.setChecked(!1,!1);const N=function(f){f.childNodes.forEach(k=>{k.isLeaf||k.setChecked(!1,!1),N(k)})};N(r)}}}setCheckedNodes(e,n=!1){const a=this.key,o={};e.forEach(s=>{o[(s||{})[a]]=!0}),this._setCheckedKeys(a,n,o)}setCheckedKeys(e,n=!1){this.defaultCheckedKeys=e;const a=this.key,o={};e.forEach(s=>{o[s]=!0}),this._setCheckedKeys(a,n,o)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach(n=>{const a=this.getNode(n);a&&a.expand(null,this.autoExpandParent)})}setChecked(e,n,a){const o=this.getNode(e);o&&o.setChecked(!!n,a)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const n=this.currentNode;n&&(n.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,n=!0){var a;const o=e[this.key],s=this.nodesMap[o];this.setCurrentNode(s),n&&this.currentNode&&this.currentNode.level>1&&((a=this.currentNode.parent)==null||a.expand(null,!0))}setCurrentNodeKey(e,n=!0){var a;if(this.currentNodeKey=e,Ne(e)){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const o=this.getNode(e);o&&(this.setCurrentNode(o),n&&this.currentNode&&this.currentNode.level>1&&((a=this.currentNode.parent)==null||a.expand(null,!0)))}}const ye="RootTree",Ae="NodeInstance",ve="TreeNodeMap",vt=U({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(t){const e=W("tree"),n=H(Ae),a=H(ye);return()=>{const o=t.node,{data:s,store:d}=o;return t.renderContent?t.renderContent(ke,{_self:n,node:o,data:s,store:d}):pe(a.ctx.slots,"default",{node:o,data:s},()=>[ke(Nt,{tag:"span",truncated:!0,class:e.be("node","label")},()=>[o.label])])}}});var mt=ae(vt,[["__file","tree-node-content.vue"]]);function Le(t){const e=H(ve,null),n={treeNodeExpand:a=>{var o;t.node!==a&&((o=t.node)==null||o.collapse())},children:[]};return e&&e.children.push(n),X(ve,n),{broadcastExpanded:a=>{if(t.accordion)for(const o of n.children)o.treeNodeExpand(a)}}}const Oe=Symbol("dragEvents");function bt({props:t,ctx:e,el$:n,dropIndicator$:a,store:o}){const s=W("tree"),d=D({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return X(Oe,{treeNodeDragStart:({event:r,treeNode:y})=>{if(r.dataTransfer){if(se(t.allowDrag)&&!t.allowDrag(y.node))return r.preventDefault(),!1;r.dataTransfer.effectAllowed="move";try{r.dataTransfer.setData("text/plain","")}catch{}d.value.draggingNode=y,e.emit("node-drag-start",y.node,r)}},treeNodeDragOver:({event:r,treeNode:y})=>{if(!r.dataTransfer)return;const u=y,N=d.value.dropNode;N&&N.node.id!==u.node.id&&de(N.$el,s.is("drop-inner"));const f=d.value.draggingNode;if(!f||!u)return;let p=!0,k=!0,m=!0,b=!0;se(t.allowDrop)&&(p=t.allowDrop(f.node,u.node,"prev"),b=k=t.allowDrop(f.node,u.node,"inner"),m=t.allowDrop(f.node,u.node,"next")),r.dataTransfer.dropEffect=k||p||m?"move":"none",(p||k||m)&&(N==null?void 0:N.node.id)!==u.node.id&&(N&&e.emit("node-drag-leave",f.node,N.node,r),e.emit("node-drag-enter",f.node,u.node,r)),p||k||m?d.value.dropNode=u:d.value.dropNode=null,u.node.nextSibling===f.node&&(m=!1),u.node.previousSibling===f.node&&(p=!1),u.node.contains(f.node,!1)&&(k=!1),(f.node===u.node||f.node.contains(u.node))&&(p=!1,k=!1,m=!1);const T=u.$el,R=T.querySelector(`.${s.be("node","content")}`).getBoundingClientRect(),j=n.value.getBoundingClientRect();let w;const V=p?k?.25:m?.45:1:-1,ee=m?k?.75:p?.55:0:1;let h=-9999;const C=r.clientY-R.top;C<R.height*V?w="before":C>R.height*ee?w="after":k?w="inner":w="none";const E=T.querySelector(`.${s.be("node","expand-icon")}`).getBoundingClientRect(),A=a.value;w==="before"?h=E.top-j.top:w==="after"&&(h=E.bottom-j.top),A.style.top=`${h}px`,A.style.left=`${E.right-j.left}px`,w==="inner"?rt(T,s.is("drop-inner")):de(T,s.is("drop-inner")),d.value.showDropIndicator=w==="before"||w==="after",d.value.allowDrop=d.value.showDropIndicator||b,d.value.dropType=w,e.emit("node-drag-over",f.node,u.node,r)},treeNodeDragEnd:r=>{var y,u;const{draggingNode:N,dropType:f,dropNode:p}=d.value;if(r.preventDefault(),r.dataTransfer&&(r.dataTransfer.dropEffect="move"),N!=null&&N.node.data&&p){const k={data:N.node.data};f!=="none"&&N.node.remove(),f==="before"?(y=p.node.parent)==null||y.insertBefore(k,p.node):f==="after"?(u=p.node.parent)==null||u.insertAfter(k,p.node):f==="inner"&&p.node.insertChild(k),f!=="none"&&(o.value.registerNode(k),o.value.key&&N.node.eachNode(m=>{var b;(b=o.value.nodesMap[m.data[o.value.key]])==null||b.setChecked(m.checked,!o.value.checkStrictly)})),de(p.$el,s.is("drop-inner")),e.emit("node-drag-end",N.node,p.node,f,r),f!=="none"&&e.emit("node-drop",N.node,p.node,f,r)}N&&!p&&e.emit("node-drag-end",N.node,null,f,r),d.value.showDropIndicator=!1,d.value.draggingNode=null,d.value.dropNode=null,d.value.allowDrop=!0}}),{dragState:d}}const Et=U({name:"ElTreeNode",components:{ElCollapseTransition:dt,ElCheckbox:Ve,NodeContent:mt,ElIcon:it,Loading:We},props:{node:{type:F,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:Boolean},emits:["node-expand"],setup(t,e){const n=W("tree"),{broadcastExpanded:a}=Le(t),o=H(ye),s=D(!1),d=D(!1),l=D(),c=D(),g=D(),r=H(Oe),y=Ie();X(Ae,y),t.node.expanded&&(s.value=!0,d.value=!0);const u=o.props.props.children||"children";S(()=>{var h;const C=(h=t.node.data)==null?void 0:h[u];return C&&[...C]},()=>{t.node.updateChildren()}),S(()=>t.node.indeterminate,h=>{p(t.node.checked,h)}),S(()=>t.node.checked,h=>{p(h,t.node.indeterminate)}),S(()=>t.node.childNodes.length,()=>t.node.reInitChecked()),S(()=>t.node.expanded,h=>{Z(()=>s.value=h),h&&(d.value=!0)});const N=h=>ge(o.props.nodeKey,h.data),f=h=>{const C=t.props.class;if(!C)return{};let E;if(se(C)){const{data:A}=h;E=C(A,h)}else E=C;return xe(E)?{[E]:!0}:E},p=(h,C)=>{(l.value!==h||c.value!==C)&&o.ctx.emit("check-change",t.node.data,h,C),l.value=h,c.value=C},k=h=>{ue(o.store,o.ctx.emit,()=>{var C;if((C=o==null?void 0:o.props)==null?void 0:C.nodeKey){const A=N(t.node);o.store.value.setCurrentNodeKey(A)}else o.store.value.setCurrentNode(t.node)}),o.currentNode.value=t.node,o.props.expandOnClickNode&&b(),(o.props.checkOnClickNode||t.node.isLeaf&&o.props.checkOnClickLeaf&&t.showCheckbox)&&!t.node.disabled&&T(!t.node.checked),o.ctx.emit("node-click",t.node.data,t.node,y,h)},m=h=>{var C;(C=o.instance.vnode.props)!=null&&C.onNodeContextmenu&&(h.stopPropagation(),h.preventDefault()),o.ctx.emit("node-contextmenu",h,t.node.data,t.node,y)},b=()=>{t.node.isLeaf||(s.value?(o.ctx.emit("node-collapse",t.node.data,t.node,y),t.node.collapse()):t.node.expand(()=>{e.emit("node-expand",t.node.data,t.node,y)}))},T=h=>{t.node.setChecked(h,!(o!=null&&o.props.checkStrictly)),Z(()=>{const C=o.store.value;o.ctx.emit("check",t.node.data,{checkedNodes:C.getCheckedNodes(),checkedKeys:C.getCheckedKeys(),halfCheckedNodes:C.getHalfCheckedNodes(),halfCheckedKeys:C.getHalfCheckedKeys()})})};return{ns:n,node$:g,tree:o,expanded:s,childNodeRendered:d,oldChecked:l,oldIndeterminate:c,getNodeKey:N,getNodeClass:f,handleSelectChange:p,handleClick:k,handleContextMenu:m,handleExpandIconClick:b,handleCheckChange:T,handleChildNodeExpand:(h,C,E)=>{a(C),o.ctx.emit("node-expand",h,C,E)},handleDragStart:h=>{o.props.draggable&&r.treeNodeDragStart({event:h,treeNode:t})},handleDragOver:h=>{h.preventDefault(),o.props.draggable&&r.treeNodeDragOver({event:h,treeNode:{$el:g.value,node:t.node}})},handleDrop:h=>{h.preventDefault()},handleDragEnd:h=>{o.props.draggable&&r.treeNodeDragEnd(h)},CaretRight:Je}}});function Kt(t,e,n,a,o,s){const d=M("el-icon"),l=M("el-checkbox"),c=M("loading"),g=M("node-content"),r=M("el-tree-node"),y=M("el-collapse-transition");return le((K(),z("div",{ref:"node$",class:x([t.ns.b("node"),t.ns.is("expanded",t.expanded),t.ns.is("current",t.node.isCurrent),t.ns.is("hidden",!t.node.visible),t.ns.is("focusable",!t.node.disabled),t.ns.is("checked",!t.node.disabled&&t.node.checked),t.getNodeClass(t.node)]),role:"treeitem",tabindex:"-1","aria-expanded":t.expanded,"aria-disabled":t.node.disabled,"aria-checked":t.node.checked,draggable:t.tree.props.draggable,"data-key":t.getNodeKey(t.node),onClick:O(t.handleClick,["stop"]),onContextmenu:t.handleContextMenu,onDragstart:O(t.handleDragStart,["stop"]),onDragover:O(t.handleDragOver,["stop"]),onDragend:O(t.handleDragEnd,["stop"]),onDrop:O(t.handleDrop,["stop"])},[he("div",{class:x(t.ns.be("node","content")),style:Ke({paddingLeft:(t.node.level-1)*t.tree.props.indent+"px"})},[t.tree.props.icon||t.CaretRight?(K(),_(d,{key:0,class:x([t.ns.be("node","expand-icon"),t.ns.is("leaf",t.node.isLeaf),{expanded:!t.node.isLeaf&&t.expanded}]),onClick:O(t.handleExpandIconClick,["stop"])},{default:G(()=>[(K(),_(De(t.tree.props.icon||t.CaretRight)))]),_:1},8,["class","onClick"])):Y("v-if",!0),t.showCheckbox?(K(),_(l,{key:1,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:!!t.node.disabled,onClick:O(()=>{},["stop"]),onChange:t.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):Y("v-if",!0),t.node.loading?(K(),_(d,{key:2,class:x([t.ns.be("node","loading-icon"),t.ns.is("loading")])},{default:G(()=>[P(c)]),_:1},8,["class"])):Y("v-if",!0),P(g,{node:t.node,"render-content":t.renderContent},null,8,["node","render-content"])],6),P(y,null,{default:G(()=>[!t.renderAfterExpand||t.childNodeRendered?le((K(),z("div",{key:0,class:x(t.ns.be("node","children")),role:"group","aria-expanded":t.expanded,onClick:O(()=>{},["stop"])},[(K(!0),z(Se,null,Te(t.node.childNodes,u=>(K(),_(r,{key:t.getNodeKey(u),"render-content":t.renderContent,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,node:u,accordion:t.accordion,props:t.props,onNodeExpand:t.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded","onClick"])),[[ce,t.expanded]]):Y("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[ce,t.node.visible]])}var Dt=ae(Et,[["render",Kt],["__file","tree-node.vue"]]);function wt({el$:t},e){const n=W("tree");be(()=>{o()}),Ee(()=>{Array.from(t.value.querySelectorAll("input[type=checkbox]")).forEach(d=>{d.setAttribute("tabindex","-1")})}),lt(t,"keydown",s=>{const d=s.target;if(!d.className.includes(n.b("node")))return;const l=s.code,c=Array.from(t.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`)),g=c.indexOf(d);let r;if([B.up,B.down].includes(l)){if(s.preventDefault(),l===B.up){r=g===-1?0:g!==0?g-1:c.length-1;const u=r;for(;!e.value.getNode(c[r].dataset.key).canFocus;){if(r--,r===u){r=-1;break}r<0&&(r=c.length-1)}}else{r=g===-1?0:g<c.length-1?g+1:0;const u=r;for(;!e.value.getNode(c[r].dataset.key).canFocus;){if(r++,r===u){r=-1;break}r>=c.length&&(r=0)}}r!==-1&&c[r].focus()}[B.left,B.right].includes(l)&&(s.preventDefault(),d.click());const y=d.querySelector('[type="checkbox"]');[B.enter,B.numpadEnter,B.space].includes(l)&&y&&(s.preventDefault(),y.click())});const o=()=>{var s;if(!t.value)return;const d=Array.from(t.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`));Array.from(t.value.querySelectorAll("input[type=checkbox]")).forEach(g=>{g.setAttribute("tabindex","-1")});const c=t.value.querySelectorAll(`.${n.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(s=d[0])==null||s.setAttribute("tabindex","0")}}const xt=U({name:"ElTree",components:{ElTreeNode:Dt},props:{data:{type:ne(Array),default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkOnClickLeaf:{type:Boolean,default:!0},checkDescendants:Boolean,autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:{type:ne(Function)},showCheckbox:Boolean,draggable:Boolean,allowDrag:{type:ne(Function)},allowDrop:{type:ne(Function)},props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:Boolean,highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:ut}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(t,e){const{t:n}=Qe(),a=W("tree"),o=H(at,null),s=D(new Ct({key:t.nodeKey,data:t.data,lazy:t.lazy,props:t.props,load:t.load,currentNodeKey:t.currentNodeKey,checkStrictly:t.checkStrictly,checkDescendants:t.checkDescendants,defaultCheckedKeys:t.defaultCheckedKeys,defaultExpandedKeys:t.defaultExpandedKeys,autoExpandParent:t.autoExpandParent,defaultExpandAll:t.defaultExpandAll,filterNodeMethod:t.filterNodeMethod}));s.value.initialize();const d=D(s.value.root),l=D(null),c=D(null),g=D(null),{broadcastExpanded:r}=Le(t),{dragState:y}=bt({props:t,ctx:e,el$:c,dropIndicator$:g,store:s});wt({el$:c},s);const u=me(()=>{const{childNodes:i}=d.value,v=o?o.hasFilteredOptions!==0:!1;return(!i||i.length===0||i.every(({visible:L})=>!L))&&!v});S(()=>t.currentNodeKey,i=>{s.value.setCurrentNodeKey(i??null)}),S(()=>t.defaultCheckedKeys,i=>{s.value.setDefaultCheckedKey(i??[])}),S(()=>t.defaultExpandedKeys,i=>{s.value.setDefaultExpandedKeys(i??[])}),S(()=>t.data,i=>{s.value.setData(i)},{deep:!0}),S(()=>t.checkStrictly,i=>{s.value.checkStrictly=i});const N=i=>{if(!t.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");s.value.filter(i)},f=i=>ge(t.nodeKey,i.data),p=i=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const v=s.value.getNode(i);if(!v)return[];const L=[v.data];let J=v.parent;for(;J&&J!==d.value;)L.push(J.data),J=J.parent;return L.reverse()},k=(i,v)=>s.value.getCheckedNodes(i,v),m=i=>s.value.getCheckedKeys(i),b=()=>{const i=s.value.getCurrentNode();return i?i.data:null},T=()=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const i=b();return i?i[t.nodeKey]:null},R=(i,v)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");s.value.setCheckedNodes(i,v)},j=(i,v)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");s.value.setCheckedKeys(i,v)},w=(i,v,L)=>{s.value.setChecked(i,v,L)},V=()=>s.value.getHalfCheckedNodes(),ee=()=>s.value.getHalfCheckedKeys(),h=(i,v=!0)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");ue(s,e.emit,()=>{r(i),s.value.setUserCurrentNode(i,v)})},C=(i,v=!0)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");ue(s,e.emit,()=>{r(),s.value.setCurrentNodeKey(i??null,v)})},E=i=>s.value.getNode(i),A=i=>{s.value.remove(i)},Be=(i,v)=>{s.value.append(i,v)},Me=(i,v)=>{s.value.insertBefore(i,v)},_e=(i,v)=>{s.value.insertAfter(i,v)},Pe=(i,v,L)=>{r(v),e.emit("node-expand",i,v,L)},$e=(i,v)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");s.value.updateChildren(i,v)};return X(ye,{ctx:e,props:t,store:s,root:d,currentNode:l,instance:Ie()}),X(ct,void 0),{ns:a,store:s,root:d,currentNode:l,dragState:y,el$:c,dropIndicator$:g,isEmpty:u,filter:N,getNodeKey:f,getNodePath:p,getCheckedNodes:k,getCheckedKeys:m,getCurrentNode:b,getCurrentKey:T,setCheckedNodes:R,setCheckedKeys:j,setChecked:w,getHalfCheckedNodes:V,getHalfCheckedKeys:ee,setCurrentNode:h,setCurrentKey:C,t:n,getNode:E,remove:A,append:Be,insertBefore:Me,insertAfter:_e,handleNodeExpand:Pe,updateKeyChildren:$e}}});function St(t,e,n,a,o,s){const d=M("el-tree-node");return K(),z("div",{ref:"el$",class:x([t.ns.b(),t.ns.is("dragging",!!t.dragState.draggingNode),t.ns.is("drop-not-allow",!t.dragState.allowDrop),t.ns.is("drop-inner",t.dragState.dropType==="inner"),{[t.ns.m("highlight-current")]:t.highlightCurrent}]),role:"tree"},[(K(!0),z(Se,null,Te(t.root.childNodes,l=>(K(),_(d,{key:t.getNodeKey(l),node:l,props:t.props,accordion:t.accordion,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,"render-content":t.renderContent,onNodeExpand:t.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),t.isEmpty?(K(),z("div",{key:0,class:x(t.ns.e("empty-block"))},[pe(t.$slots,"empty",{},()=>{var l;return[he("span",{class:x(t.ns.e("empty-text"))},Ye((l=t.emptyText)!=null?l:t.t("el.tree.emptyText")),3)]})],2)):Y("v-if",!0),le(he("div",{ref:"dropIndicator$",class:x(t.ns.e("drop-indicator"))},null,2),[[ce,t.dragState.showDropIndicator]])],2)}var Tt=ae(xt,[["render",St],["__file","tree.vue"]]);const It=we(Tt),At={pageName:"role",formItems:[{type:"input",prop:"name",label:"角色名称",placeholder:"请输入查询的角色名称",initialValue:""},{type:"input",prop:"leader",label:"权限介绍",placeholder:"请输入查询的权限介绍"},{type:"date-picker",prop:"createAt",label:"创建时间"}]},Lt={pageName:"role",header:{title:"角色列表",btnTitle:"新建角色"},propsList:[{type:"selection",label:"选择",width:"80px"},{type:"index",label:"序号",width:"80px"},{type:"normal",label:"角色名称",prop:"name",width:"150px"},{type:"normal",label:"权限介绍",prop:"intro",width:"180px"},{type:"timer",label:"创建时间",prop:"createAt"},{type:"timer",label:"更新时间",prop:"updateAt"},{type:"handler",label:"操作",width:"150px"}]},Ot={pageName:"role",header:{newTitle:"新建角色",editTitle:"编辑角色"},formItems:[{type:"input",label:"角色名称",prop:"name",placeholder:"请输入角色名称"},{type:"input",label:"权限介绍",prop:"intro",placeholder:"请输入权限介绍"},{type:"custom",slotName:"menulist"}]},Bt={class:"role"},Qt=U({__name:"role",setup(t){const{contentRef:e,handleQueryClick:n,handleResetClick:a}=et(),{modalRef:o,handleNewClick:s,handleEditClick:d}=tt(u,N),l=Ge(),{entireMenus:c}=Ze(l),g=D({});function r(f,p){const k=[...p.checkedKeys,...p.halfCheckedKeys];console.log(p.checkedKeys),g.value={menuList:k}}const y=D();function u(){Z(()=>{var f;(f=y.value)==null||f.setCheckedKeys([])})}function N(f){Z(()=>{var k;const p=Xe(f.menuList);(k=y.value)==null||k.setCheckedKeys(p)})}return(f,p)=>{const k=It;return K(),z("div",Bt,[P(nt,{"search-config":I(At),onQueryClick:I(n),onResetClick:I(a)},null,8,["search-config","onQueryClick","onResetClick"]),P(st,{"content-config":I(Lt),ref_key:"contentRef",ref:e,onNewClick:I(s),onEditClick:I(d)},null,8,["content-config","onNewClick","onEditClick"]),P(ot,{"modal-config":I(Ot),"other-info":g.value,ref_key:"modalRef",ref:o},{menulist:G(()=>[P(k,{ref_key:"treeRef",ref:y,data:I(c),"show-checkbox":"","node-key":"id",props:{children:"children",label:"name"},onCheck:r},null,8,["data"])]),_:1},8,["modal-config","other-info"])])}}});export{Qt as default};
